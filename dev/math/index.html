<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Mathematical properties of B-spline · BasicBSpline.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">BasicBSpline.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Mathematical properties of B-spline</a><ul class="internal"><li><a class="tocitem" href="#Introduction-1"><span>Introduction</span></a></li><li><a class="tocitem" href="#Knot-vector-1"><span>Knot vector</span></a></li><li><a class="tocitem" href="#B-spline-space-1"><span>B-spline space</span></a></li><li><a class="tocitem" href="#Inclusive-relationship-between-B-spline-spaces-1"><span>Inclusive relationship between B-spline spaces</span></a></li><li><a class="tocitem" href="#B-spline-basis-function-1"><span>B-spline basis function</span></a></li><li><a class="tocitem" href="#Support-of-B-spline-basis-function-1"><span>Support of B-spline basis function</span></a></li><li><a class="tocitem" href="#Derivative-of-B-spline-basis-function-1"><span>Derivative of B-spline basis function</span></a></li><li><a class="tocitem" href="#Partition-of-unity-1"><span>Partition of unity</span></a></li><li><a class="tocitem" href="#Multi-dimentional-B-spline-1"><span>Multi-dimentional B-spline</span></a></li><li><a class="tocitem" href="#B-spline-manifold-1"><span>B-spline manifold</span></a></li><li><a class="tocitem" href="#Affine-commutativity-1"><span>Affine commutativity</span></a></li><li><a class="tocitem" href="#Refinement-1"><span>Refinement</span></a></li></ul></li><li><a class="tocitem" href="../future/">Future work</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Mathematical properties of B-spline</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Mathematical properties of B-spline</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/hyrodium/BasicBSpline.jl/blob/master/docs/src/math.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Mathematical-properties-of-B-spline-1"><a class="docs-heading-anchor" href="#Mathematical-properties-of-B-spline-1">Mathematical properties of B-spline</a><a class="docs-heading-anchor-permalink" href="#Mathematical-properties-of-B-spline-1" title="Permalink"></a></h1><h2 id="Introduction-1"><a class="docs-heading-anchor" href="#Introduction-1">Introduction</a><a class="docs-heading-anchor-permalink" href="#Introduction-1" title="Permalink"></a></h2><p><a href="https://en.wikipedia.org/wiki/B-spline">B-spline</a> is a mathematical object, and it has a lot of application(e.g. <a href="https://en.wikipedia.org/wiki/Non-uniform_rational_B-spline">NURBS</a>, <a href="https://en.wikipedia.org/wiki/Isogeometric_analysis">IGA</a>).</p><p>In this page, we&#39;ll explain the mathematical definition and property of B-spline with Julia code.</p><p>Before running the following code, do not forget importing the package:</p><pre><code class="language-julia">using BasicBSpline</code></pre><h2 id="Knot-vector-1"><a class="docs-heading-anchor" href="#Knot-vector-1">Knot vector</a><a class="docs-heading-anchor-permalink" href="#Knot-vector-1" title="Permalink"></a></h2><p>A finite sequence</p><div>\[k=(k_1, \dots, k_l)\]</div><p>is called <strong>knot vector</strong> if the sequence is broad monotonic increase, i.e. (<span>$k_{i} \le k_{i+1}$</span>)</p><pre><code class="language-julia">k=Knots([1,2,3])</code></pre><p>We denotes a number of knots by <em>sharp</em> symbol like this:</p><div>\[\sharp k=\sharp(k_1, \dots, k_l) =l\]</div><pre><code class="language-julia">♯(k) # 3
length(k) # 3</code></pre><p>We introduce additional operator <span>$+$</span> and product operator <span>$\cdot$</span></p><div>\[\begin{aligned}
k^{(1)}+k^{(2)}
&amp;=(k^{(1)}_1, \dots, k^{(1)}_l) + (k^{(2)}_1, \dots, k^{(2)}_l) \\
&amp;=(\text{sort of union of} \  k^{(1)} \ \text{and} \  k^{(2)} \text{)} \\
nk&amp;=\underbrace{k+\cdots+k}_{n}
\end{aligned}\]</div><p>For example, <span>$(1,2,3)+(2,4,5)=(1,2,2,3,5)$</span>, <span>$2\cdot (2,3)=(2,2,3,3)$</span></p><pre><code class="language-julia">k = Knots([1,2,3]) + Knots([2,4,5]) # Knots([1,2,2,3,5])
2Knots([2,3]) # Knots([2,2,3,3])</code></pre><p>Unique operator</p><div>\[\begin{aligned}
\widehat{k}
&amp;=(\text{remove duplicates of} \  k) \\
\end{aligned}\]</div><p>For example, <span>$\widehat{(1,2,2,3)}=(1,2,3)$</span>.</p><pre><code class="language-julia">unique(Knots([1,2,2,3])) # Knots([1,2,3])</code></pre><h2 id="B-spline-space-1"><a class="docs-heading-anchor" href="#B-spline-space-1">B-spline space</a><a class="docs-heading-anchor-permalink" href="#B-spline-space-1" title="Permalink"></a></h2><p>Space of Piecewise polynominal.</p><div>\[\mathcal{P}[p,k]
=..\]</div><p>where <span>$p\ge 0$</span> is called polynominal degree of space, and <span>$k$</span> is a knot vector.</p><pre><code class="language-julia">p = 2
k = [1,3,5,6,8,9]
BSplineSpace(p,k)
𝒫(p,k) # same as above, for legibility</code></pre><p>A B-spline space is said to be <strong>proper</strong> if its degree and knots satisfies following property:</p><div>\[\begin{aligned}
k_{i}&amp;&lt;k_{i+p+1} &amp; (1 \le i \le l-p-1)
\end{aligned}\]</div><pre><code class="language-julia">isproper(𝒫(2,Knots([1,3,5,6,8,9]))) # true
isproper(𝒫(1,Knots([1,3,3,3,8,9]))) # false</code></pre><p>The B-spline space is linear space, and if a B-spline space is proper, its dimension is calculated by:</p><div>\[\dim(\mathcal{P}[p,k])=\sharp k -p -1\]</div><pre><code class="language-julia">dim(𝒫(2,Knots([1,3,5,6,8,9]))) # 3</code></pre><h2 id="Inclusive-relationship-between-B-spline-spaces-1"><a class="docs-heading-anchor" href="#Inclusive-relationship-between-B-spline-spaces-1">Inclusive relationship between B-spline spaces</a><a class="docs-heading-anchor-permalink" href="#Inclusive-relationship-between-B-spline-spaces-1" title="Permalink"></a></h2><p>For proper B-spline spaces, the following relationship holds.</p><div>\[\mathcal{P}[p,k]
\subseteq \mathcal{P}[p&#39;,k&#39;]
\Leftrightarrow (m=p&#39;-p \ge 0 \ \text{and} \ k+m\widehat{k}\subseteq k&#39;)\]</div><pre><code class="language-julia">P1 = 𝒫(2,Knots([1,3,5])
P2 = 𝒫(2,Knots([1,3,5,6,8,9])
P3 = 𝒫(3,Knots([1,1,3,3,5,5])
P1 ⊆ P2 # true
P1 ⊆ P3 # true
P2 ⊆ P3 # false</code></pre><h2 id="B-spline-basis-function-1"><a class="docs-heading-anchor" href="#B-spline-basis-function-1">B-spline basis function</a><a class="docs-heading-anchor-permalink" href="#B-spline-basis-function-1" title="Permalink"></a></h2><p>B-spline basis function is defined by Cox–de Boor recursion formula.</p><div>\[\begin{aligned}
{B}_{(i,p,k)}(t)
&amp;=
\frac{t-k_{i}}{k_{i+p}-k_{i}}{B}_{(i,p-1,k)}(t)
+\frac{k_{i+p+1}-t}{k_{i+p+1}-k_{i+1}}{B}_{(i+1,p-1,k)}(t) \\
{B}_{(i,0,k)}(t)
&amp;=
\begin{cases}
    &amp;1\quad (k_{i}\le t&lt; k_{i+1})\\
    &amp;0\quad (\text{otherwise})
\end{cases}
\end{aligned}\]</div><p>You can choose the first terms in different ways.</p><div>\[\begin{aligned}
{B}_{(i,0,k)}(t)
&amp;=
\begin{cases}
    &amp;1\quad (k_{i} &lt; t \le k_{i+1}\\
    &amp;0\quad (\text{otherwise})
\end{cases}
\end{aligned}\]</div><div>\[\begin{aligned}
{B}_{(i,0,k)}(t)
&amp;=
\begin{cases}
    &amp;1\quad (k_{i}\le t&lt;k_{i+1}&lt;k_{l})\\
    &amp;1\quad (k_{i}\le t\le k_{i+1}=k_{l})\\
    &amp;0\quad (\text{otherwise})
\end{cases}
\end{aligned}\]</div><pre><code class="language-julia">using Plots
gr()
...</code></pre><h2 id="Support-of-B-spline-basis-function-1"><a class="docs-heading-anchor" href="#Support-of-B-spline-basis-function-1">Support of B-spline basis function</a><a class="docs-heading-anchor-permalink" href="#Support-of-B-spline-basis-function-1" title="Permalink"></a></h2><p>If a B-spline space<span>$\mathcal{P}[p,k]$</span> is proper, the support of its basis function is calculated as follows:</p><div>\[\operatorname{supp}(B_{(i,p,k)})=[k_{i},k_{i+p+1}]\]</div><pre><code class="language-julia">i=2
k=Knots([5,12,13,13,14])
p=2
P=𝒫(p,k)
BSplineSupport(P) # [5..13, 12..14]
BSplineSupport(i,P) # 12..14</code></pre><h2 id="Derivative-of-B-spline-basis-function-1"><a class="docs-heading-anchor" href="#Derivative-of-B-spline-basis-function-1">Derivative of B-spline basis function</a><a class="docs-heading-anchor-permalink" href="#Derivative-of-B-spline-basis-function-1" title="Permalink"></a></h2><div>\[\begin{aligned}
\dot{B}_{(i,p,k)}(t)
&amp;=\frac{d}{dt}B_{(i,p,k)}(t) \\
&amp;=p\left(\frac{1}{k_{i+p}-k_{i}}B_{(i,p-1,k)}(t)-\frac{1}{k_{i+p+1}-k_{i+1}}B_{(i+1,p-1,k)}(t)\right)
\end{aligned}\]</div><p>Note that<span>$\dot{B}_{(i,p,k)}\in\mathcal{P}[p-1,k]$</span>.</p><h2 id="Partition-of-unity-1"><a class="docs-heading-anchor" href="#Partition-of-unity-1">Partition of unity</a><a class="docs-heading-anchor-permalink" href="#Partition-of-unity-1" title="Permalink"></a></h2><div>\[\begin{aligned}
\sum_{i}B_{(i,p,k)}(t) &amp;= 1 &amp; (k_{p+1}&lt; t &lt;k_{l-p}) \\
0 \le B_{(i,p,k)}(t) &amp;\le 1
\end{aligned}\]</div><h2 id="Multi-dimentional-B-spline-1"><a class="docs-heading-anchor" href="#Multi-dimentional-B-spline-1">Multi-dimentional B-spline</a><a class="docs-heading-anchor-permalink" href="#Multi-dimentional-B-spline-1" title="Permalink"></a></h2><div>\[B_{i^1,\dots,i^d}(t^1,\dots,t^d)
=B_{(i^1,p^1,k^1)}(t^1)\cdots B_{(i^d,p^d,k^d)}(t^d)\]</div><h2 id="B-spline-manifold-1"><a class="docs-heading-anchor" href="#B-spline-manifold-1">B-spline manifold</a><a class="docs-heading-anchor-permalink" href="#B-spline-manifold-1" title="Permalink"></a></h2><div>\[\bm{p}(t^1,\dots,t^d;\bm{a}_{i^1,\dots,i^d})
=\sum_{i^1,\dots,i^d}B_{i^1,\dots,i^d}(t^1,\dots,t^d) \bm{a}_{i^1,\dots,i^d}\]</div><p>where <span>$\bm{a}_{i^1,\dots,i^d}$</span> is called <strong>control points</strong></p><p>We will also write <span>$\bm{p}(t^1,\dots,t^d; \bm{a})$</span>, <span>$\bm{p}(t^1,\dots,t^d)$</span>, <span>$\bm{p}(t; \bm{a})$</span> or <span>$\bm{p}(t)$</span> for simplicity.</p><h3 id="B-spline-curve-1"><a class="docs-heading-anchor" href="#B-spline-curve-1">B-spline curve</a><a class="docs-heading-anchor-permalink" href="#B-spline-curve-1" title="Permalink"></a></h3><h3 id="B-spline-surface-1"><a class="docs-heading-anchor" href="#B-spline-surface-1">B-spline surface</a><a class="docs-heading-anchor-permalink" href="#B-spline-surface-1" title="Permalink"></a></h3><h2 id="Affine-commutativity-1"><a class="docs-heading-anchor" href="#Affine-commutativity-1">Affine commutativity</a><a class="docs-heading-anchor-permalink" href="#Affine-commutativity-1" title="Permalink"></a></h2><p>If <span>$T$</span> is a affine transform <span>$T:\mathbb{R}^d\to\mathbb{R}^d$</span>, then ..</p><div>\[T(\bm{p}(t; \bm{a}))
=\bm{p}(t; T(a))\]</div><h2 id="Refinement-1"><a class="docs-heading-anchor" href="#Refinement-1">Refinement</a><a class="docs-heading-anchor-permalink" href="#Refinement-1" title="Permalink"></a></h2></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../future/">Future work »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 26 April 2020 10:34">Sunday 26 April 2020</span>. Using Julia version 1.0.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
